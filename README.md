# Wildberries Category Parser

Этот скрипт парсит все категории и подкатегории из главного меню сайта Wildberries ([https://www.wildberries.ru/](https://www.wildberries.ru/)) и сохраняет их в Excel-файл по категориям (каждая категория — отдельный лист, структура — "имя категории/подкатегории", "уровень вложенности").

## Особенности

* Обходит все вложенные подменю любого уровня.
* Корректно работает с динамическим JavaScript-меню Wildberries.
* Для каждой основной категории создаёт отдельный лист в Excel-файле (`wb_menu_by_category.xlsx`).

## Почему Playwright?

* **Меню Wildberries полностью динамическое:** подкатегории появляются только после клика, а HTML меняется "на лету".
* **Scrapy** не подходит, потому что не исполняет JS (это чистый парсер HTML и HTTP-запросов).
* **Selenium** позволяет работать с динамическим DOM, но он **только синхронный** и гораздо медленнее, чем Playwright, хуже поддерживает работу с несколькими страницами, и хуже "понимает" новые сайты.
* **Playwright** поддерживает современный асинхронный API (как `async_playwright`), более надёжен при работе со сложными JS-сайтами, чем Selenium.
* **Playwright быстрее и стабильнее** для таких задач: можно работать асинхронно, ловить JS-изменения, кликать на нужные элементы, ловить появление новых меню.

## Используемые библиотеки

* [`playwright`](https://github.com/microsoft/playwright-python) — для эмуляции браузера и взаимодействия с динамическим меню.
* [`pandas`](https://pandas.pydata.org/) — для удобного сохранения результатов в Excel-файл.

## Установка

```bash
pip install -r requirements.txt
python -m playwright install
```

## Запуск

```bash
python main.py
```

## Результат

* Excel-файл `wb_menu_by_category.xlsx`, в котором на каждом листе — вся иерархия выбранной категории и подкатегорий.

---

## Почему не Scrapy?

* Scrapy — отличный инструмент для статических сайтов, но не умеет взаимодействовать с JS-меню (не может "кликать").
* Для современных динамических сайтов Scrapy **не увидит** подкатегорий, потому что они появляются только после действий пользователя.

## Почему не Selenium?

* Selenium хорош для автоматизации браузера, но у него нет полноценной поддержки асинхронного кода (только sync API).
* Playwright проще масштабировать (можно запускать несколько браузеров, страниц, работать асинхронно).
* Playwright "роднее" поддерживает новые сайты, быстрее работает с динамическим контентом.

---

## Краткое описание логики

1. Скрипт открывает сайт Wildberries, кликает на "бургер-меню".
2. Поочередно кликает по каждой категории и рекурсивно собирает все подкатегории (вложенность — любая).
3. Все найденные категории/подкатегории с их уровнем сохраняет в Excel.

---

**P.S.**
Если у тебя есть вопросы или хочется доработать парсер под другие сайты — пиши!

---

Если нужно, могу добавить английский README и пример работы/скриншоты.
Можешь подстроить текст под себя — если хочешь более формально или наоборот, попроще!
